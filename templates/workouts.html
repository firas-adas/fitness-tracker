{% extends "layout.html" %}
{% block content %}

<h2>Workouts for User #{{ user_id }}</h2>

<a class="btn" href="{{ url_for('add_workout_form', user_id=user_id) }}">➕ Add Workout</a>

<table>
    <tr>
        <th>ID</th>
        <th>Workout Type</th>
        <th>Duration (min)</th>
        <th>Calories Burned</th>
        <th>Date</th>
        <th>Delete</th>
    </tr>

    {% for w in workouts %}
    <!-- Workout row -->
    <tr>
        <td>{{ w.workout_id }}</td>
        <td>{{ w.workout_type }}</td>
        <td>{{ w.duration }} min</td>
        <td>{{ w.calories_burned }} kcal</td>
        <td>{{ w.workout_date }}</td>
        <td>
            <a style="color:red;" href="{{ url_for('delete_workout_route', id=w.workout_id) }}">
                ❌ Delete
            </a>
        </td>
    </tr>

    <!-- Nested sets table (only if workout has sets) -->
    {% if w.sets %}
    <tr>
        <td colspan="6">
            <table style="width:100%; margin-top:8px; border-collapse: collapse;">
                <tr>
                    <th>Set #</th>
                    <th>Exercise</th>
                    <th>Weight</th>
                    <th>Reps</th>
                    <th>RPE</th>
                    <th>Note</th>
                </tr>
                {% for s in w.sets %}
                <tr>
                    <td>{{ s.set_number }}</td>
                    <td>{{ s.exercise.exercise_name if s.exercise else 'N/A' }}</td>
                    <td>{{ s.weight }}</td>
                    <td>{{ s.reps }}</td>
                    <td>{{ s.rpe }}</td>
                    <td>{{ s.note or '' }}</td>
                </tr>
                {% endfor %}
            </table>
        </td>
    </tr>
    {% endif %}
    {% endfor %}
</table>

{% endblock %}
